<!DOCTYPE html>
<html lang="en">
<head>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.0.272/jspdf.debug.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.2/rollups/aes.js" integrity="sha256-/H4YS+7aYb9kJ5OKhFYPUjSJdrtV6AeyJOtTkw6X72o=" crossorigin="anonymous"></script>

    <script src = "https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js" integrity="sha512-csNcFYJniKjJxRWRV1R7fvnXrycHP6qDR21mgz1ZP55xY5d+aHLfo9/FcGDQLfn2IfngbAHd8LdfsagcCqgTcQ==" crossorigin = "anonymous" referrerpolicy = "no-referrer"> </script>
    <!-- <script src="http://crypto-js.googlecode.com/svn/tags/3.1.2/build/rollups/aes.js"></script> -->
    <script src="./phoenix.js"></script>
    <link rel="stylesheet" href="styles.css">


    <!-- <script src="./verbs.js"></script> -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spanish With Mr Flores</title>
</head>
<body>
    <audio id="pfb-mp3">
        <source src="./p-fb.mp3" type="audio/mp3">
    </audio>
    <audio id="nfb-mp3">
        <source src="./n-fb.mp3" type="audio/mp3">
    </audio>
    <audio id="cash-fb-mp3">
        <source src="./cash-fb.mp3" type="audio/mp3">
    </audio>



    



    
    
    
    
    <div id="title">Spanish with Mr Flores üë®üèª‚Äçüè´</div><br>
    <!-- <h3>Common expressions exercise</h3> -->



    
    
    <label for="tense">Estudiar: </label>
    
    <select onchange="selectTense(event)" name="tense" id="tense">
        <option id="tenseToBePracticed" value="">Select topic</option>
        <option value="presente_irregular">Presente (irregular)</option>
        <option value="presente">Presente (stem-changing)</option>
        <option value="preterito">Preterito</option>
        <option value="preterito_irregular">Preterito (irregular)</option>
        <option value="imperfecto">Imperfecto</option>
        <option value="imperativo">Imperativo</option>
        <option value="expresionesImperativo">Expresiones en imperativo</option>
        <!-- <option value="ImperativoWithPronouns">imperativo con pronombres CD y CI</option> -->
    </select>
    <!-- <p>Practice: <span id="tenseToBePracticed"></span></p><br> -->
    <br><br>
    <br>
    <div id="instruction_div">
        <b id="exercise_title"></b><br><br>
        <span id="instruction"></span>
    </div><br><br>



    <div id="score_div">
        <b>Correct: </b>
        <b id="points">0</b><b>/</b>
        <b id="incorrect">0</b>
        &nbsp;
        &nbsp;
        &nbsp;
        <!-- <b>Correct/incorrect ratio: </b> -->
    
        <b>Score: </b>
        <b id="ratio">-</b>

        &nbsp;
        &nbsp;
        &nbsp;


        <b>Grade: </b>
        <b id="grade">-</b>
        <!-- <b id="progress-ui">0</b><br> -->



    </div><br><br>






    
    <div id="phrase_div">
        <div id="verb_div">
            <b id="verbo" onclick="showVerbHint()"></b><br>
            <b id="verbo_hint"></b><br><br>
        </div>
        <div id="complement_div">
            <b id="complement" onclick="showHint()"></b><br>
            <b id="complement_hint"></b><br><br>
        </div>
    <br>
    <b id="subjectToShow"></b><br>
    <input type="text" placeholder="answer" id="verboConjugado">
    <br><span id="correctAnswer"></span><br>
    <!-- <button onclick="myFunction()">Try it</button> -->
    <!-- <button>check</button> -->
    <span id="fb"></span><br>
    <!-- <button>reveal answer</button><br><br> -->
    <br><button onclick="showAnswerDialog()">üëª Reveal answer</button><br><br>
    <!-- <div id="hide" class="modal_answer">
        <span>üëª Hey!</span><br>
        <span>I will tell you the answer</span><br>
        <button>Reveal answer üí∞x 20</button>
        <button>Decline</button>
    </div> -->

    <dialog id="modal_answer">
        <span>üëª Hey!</span><br>
        <span>I will tell you the answer</span><br><br>
        <button id="answerButton" disabled onclick="getAnswer()">Reveal answer üí∞x 15</button>
        &nbsp;
        &nbsp;
        &nbsp;
        <button onclick="closeAnswerDialog()">Decline</button>
    </dialog>
      

    


    <br>
    <b>lifesavers:</b>
    <b id="lifesavers3">üõü</b>
    <b id="lifesavers2">üõü</b>
    <b id="lifesavers1">üõü</b>
    
    
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
    <b id="coins">üí∞</b><b id="coinsForHint"></b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

    <b>Progress: </b><b id="progress-ui">0</b><b>%</b><br><br>

    
    <br><br>


    <input type="text" placeholder="Nombre" id="nombre" onkeyup="success()">
    <button type = "button" disabled id="fileButon" onclick = "CreateTextFile();">Crear reporte</button>
    <div></div>

    <!-- <button onclick="generatePDF()">print Pdf</button> -->




    </div>


    
</body>
<script>
    var hintNum = 20;
    var hintUsed = false;
    var lifesavers = 3;
    var score = Number(0);
    var progress = Number(0);
    var grade = 0;
    var negScore = Number(0);
    var verbosMistakes = {};
    var fina100score = 0;
    var tense = localStorage.getItem("selectedTense");
    var verboConjugado = "";
    var tenseToBePracticed = ""
    var audioFB = document.getElementById("pfb-mp3");
    var audioNegFB = document.getElementById("nfb-mp3");
    var isSkipped = false;




    if (tense === "presente_irregular"){
        tenseToBePracticed = " irregulares en presente"
    }
    if (tense === "presente"){
        tenseToBePracticed = " con cambio de ra√≠z (stem-changing verbs) en presente"
    }
    if (tense === "preterito"){
        tenseToBePracticed = " en preterito"
    }
    if (tense === "preterito_irregular"){
        tenseToBePracticed = " irregulares en preterito"
    }
    if (tense === "imperfecto"){
        tenseToBePracticed = " imperfecto"
    }
    if (tense === "imperativo"){
        tenseToBePracticed = " imperativo"
    }
    if (tense === "expresionesImperativo"){
        tenseToBePracticed = "Expresiones en imperativo"
    }

    document.getElementById("tenseToBePracticed").innerHTML = tenseToBePracticed;



    


    function showAnswerDialog() {
        // alert()
        var modal = document.getElementById("modal_answer")



        if (hintNum >= 15) {
            document.getElementById("answerButton").disabled= false;
        }
        else {
            document.getElementById("answerButton").disabled= true;
        }


        modal.show()
    }

    function closeAnswerDialog() {
        var modal = document.getElementById("modal_answer")
        modal.close()

    }
    function getAnswer() {
        hintNum = hintNum -15;
        document.getElementById("coinsForHint").innerHTML = hintNum
        document.getElementById("correctAnswer").innerHTML = correctAnswer
        document.getElementById("cash-fb-mp3").play()
        closeAnswerDialog()
    }








    function success() {
        if(document.getElementById("nombre").value==="") { 
            document.getElementById('fileButon').disabled = true; 
        } else { 
            document.getElementById('fileButon').disabled = false;
        }
    }

    function initialize(selectedTense) {
        score = Number(0);
        progress = Number(0);
        negScore = Number(0);
        verbosMistakes = {};
        fina100score = 0;
        tense = localStorage.getItem("selectedTense");
        verboConjugado = "";
        complementHint = "";
        correctAnswer = "";
        verbHint = "";
        console.log("reset everything")
        onload()

    }


    function selectTense(e) {
        console.log("this line works")
        location.reload();
        var selectedTense = document.getElementById("tense").value = e.target.value

        localStorage.setItem("selectedTense", selectedTense);
        

        initialize(selectedTense)

    }

    function formater(name){

        var reporte = `Reporte de ${name}`



         var format = "+"


        for (var i=0; i < reporte.length + 2; i++) {
            
            format = format + "-"
        }
        format = format + `+\n|`
        format = format + " " + reporte + " |" + "\n+";

        for (var i=0; i < reporte.length + 2; i++) {
            
            format = format + "-"
        }
        format = format + `+\n\n`
        return format;
    }


    

    function encryptReport(textToEncrypt) {
        var encryptedAES = CryptoJS.AES.encrypt(textToEncrypt, "My key");
        // var decryptedBytes = CryptoJS.AES.decrypt(encryptedAES, "My key");
        // var plaintext = decryptedBytes.toString(CryptoJS.enc.Utf8);
        return encryptedAES;
    }



    function CreateTextFile() {



        

        var name = document.getElementById("nombre").value

        const d = new Date();
        var date = d.toDateString();

        var format = formater(name)


      var message1 =

`¬°Hola ${name}!

Has obtenido una calificaci√≥n de ${grade} puntos.

Respondiste correctamente a ${score} preguntas y ${negScore} incorrectas. Completaste el ejercicio en un ${fina100score}%.
Observ√© algunos detalles en los siguientes ejercicios:\n
${Object.keys(verbosMistakes)}
      `
var authenticityMessage = `Nombre: ${name}\nCalificaci√≥n: ${grade}\nRespuestas correctas:${score}\nRespuestas incorrectas:${negScore}\n Progreso: ${fina100score}%\nFecha:${date}\n Ejercicio: ${tense}`



        // var message1 = `${name}, debes terminar el ejercicio.\n\nHas completado un ${fina100score}%\n\n¬°Sigue practicando!`
        // var message2 = `¬°${name}!\n\n¬°Obtuviste ${grade} pts!\n${score} correctas y ${negScore} incorrecta(s)\n\n\nObserv√© algunos detalles en los siguientes ejercicios:\n\n  ${Object.keys(verbosMistakes)}\n\nLa pr√°ctica continua te ayudar√° a perfeccionarlos.\n `
        // var message3 = `¬°${name}, lo has hecho perfecto!\n\n¬°Obtuviste ${grade} pts sin ning√∫n error!\n\n Practicate ${score} verbos`
        var practiceMessage = `\n\nFecha: ${date} Ejercicio: ${tense} \n\n`
        var finalmessage ="dd0";

        const objKeys = Object.values(mythical)

        // 8 is the number of keys in the json and (d.getDay()+1) is 7 which is the number of days
        var picture = objKeys[d.getDay()];

        // if (fina100score >= 300){
        //     if (negScore === 0){
        //         finalmessage = format +  message3 + practiceMessage + "\n" + picture
        //     }
        //     else {
        //         finalmessage = format + message2 + practiceMessage + "\n" + picture
        //     }
        // }
        // else if (fina100score >= 100){
        //     if (negScore === 0){
        //         finalmessage = format +  message3 + practiceMessage
        //     }
        //     else {
        //         finalmessage = format + message2 + practiceMessage
        //     }
        // }
        // else {
            finalmessage = format + message1 + practiceMessage

           var MyEncryptedReport =  encryptReport(authenticityMessage)

           var finaMessageWithEncryptedReport = `${finalmessage} \n\nIntegrity Verification Key: ${MyEncryptedReport}`;



        // var encryptedAES = CryptoJS.AES.encrypt(finalmessage, "My key");
        // var decryptedBytes = CryptoJS.AES.decrypt(encryptedAES, "My key");
        // var plaintext = decryptedBytes.toString(CryptoJS.enc.Utf8);

        //    alert(encryptedAES)
        // }

        var blob = new Blob([finaMessageWithEncryptedReport], {
            type: "text/plain;charset=utf-8",
        });

        var confirmMessage = "Your progress will get eraser"

        if (confirm(`Please ensure your name is accurately entered. Once confirmed, your name cannot be edited.\n\nName: ${name}`) == true) {
            document.getElementById('nombre').disabled = true;
            saveAs(blob, "download.txt");
        }
        
        // confirm("Make sure your name is correct. Once you confirm this, you won't be able to edit your name") {
        //    
        //     
        // }
  
    }

    
    
    function showHint() {
        if(hintNum > 0 ) {
    
            hintUsed = true;
            hintNum--;
            document.getElementById("coinsForHint").innerHTML = hintNum
            var hintMessage = document.getElementById("complement_hint");
            hintMessage.innerHTML = complementHint
        }
    }

    

    function showVerbHint() {
        if(hintNum > 0) { 
            hintNum--;
            hintUsed = true;
            document.getElementById("coinsForHint").innerHTML = hintNum
            var hintMessage = document.getElementById("verbo_hint");
            hintMessage.innerHTML = verbHint
        }

    }

    function clearHint() {
        hintUsed = false;
        var verbMessage = document.getElementById("verbo_hint");
        var hintMessage = document.getElementById("complement_hint");
        verbMessage.innerHTML = ""
        hintMessage.innerHTML = ""

    }

    function clearPreviousAnswer() {
        document.getElementById("correctAnswer").innerHTML = ""
    }


    
    
  
    onload = function() {
        clearHint()
        clearPreviousAnswer()
        document.getElementById("coinsForHint").innerHTML = hintNum
        // var hintMessage = document.getElementById("verbo_hint");
        // var hintMessage = document.getElementById("complement_hint");
        // hintMessage.innerHTML = ""
        // hintMessage.innerHTML = ""




        


        
      



        console.log("____________________________-- ")

        console.log("score " + score)

        var points = document.getElementById("points")
        var incorrect = document.getElementById("incorrect")

        document.getElementById("fb").innerHTML = ""
        console.log("again")
        var verbo = document.getElementById("verbo");
        var complement = document.getElementById("complement"); 
        var subjectToShow = document.getElementById("subjectToShow");


        var irrePresent = {
            "exercice": [
    {
        "verbo": "hacer",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "hago",
            "t√∫": "haces",
            "√©l": "hace",
            "ella": "hace",
            "Ud.": "hace",
            "nosotros": "hacemos",
            "Uds.": "hacen",
            "ellos": "hacen"
        }
    },
    {
        "verbo": "poner",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "pongo",
            "t√∫": "pones",
            "√©l": "pone",
            "ella": "pone",
            "Ud.": "pone",
            "nosotros": "ponemos",
            "Uds.": "ponen",
            "ellos": "ponen"
        }
    },
    {
        "verbo": "salir",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "salgo",
            "t√∫": "sales",
            "√©l": "sale",
            "ella": "sale",
            "Ud.": "sale",
            "nosotros": "salimos",
            "Uds.": "salen",
            "ellos": "salen"
        }
    },
    {
        "verbo": "traer",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "traigo",
            "t√∫": "traes",
            "√©l": "trae",
            "ella": "trae",
            "Ud.": "trae",
            "nosotros": "traemos",
            "Uds.": "traen",
            "ellos": "traen"
        }  
    },
    {
        "verbo": "conocer",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "conozco",
            "t√∫": "conoces",
            "√©l": "conoce",
            "ella": "conoce",
            "Ud.": "conoce",
            "nosotros": "conocemos",
            "Uds.": "conocen",
            "ellos": "conocen"
        }
        
    },
    {
        "verbo": "dar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "doy",
            "t√∫": "das",
            "√©l": "da",
            "ella": "da",
            "Ud.": "da",
            "nosotros": "damos",
            "Uds.": "dan",
            "ellos": "dan"
        }
    },
    {
        "verbo": "saber",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "se",
            "t√∫": "sabes",
            "√©l": "sabe",
            "ella": "sabe",
            "Ud.": "sabe",
            "nosotros": "sabemos",
            "Uds.": "saben",
            "ellos": "saben"
        }
    },
    {
        "verbo": "ver",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "veo",
            "t√∫": "ves",
            "√©l": "ve",
            "ella": "ve",
            "Ud.": "ve",
            "nosotros": "vemos",
            "Uds.": "ven",
            "ellos": "ven"
        }
    },
]
        }

var conj = {
    "exercice": [
    {
        "verbo": "querer",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "quiero",
            "t√∫": "quieres",
            "√©l": "quiere",
            "ella": "quiere",
            "Ud.": "quiere",
            "nosotros": "queremos",
            "Uds.": "quieren",
            "ellos": "quieren"
        }
    },
    {
        "verbo": "poder",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "puedo",
            "t√∫": "puedes",
            "√©l": "puede",
            "ella": "puede",
            "Ud.": "puede",
            "nosotros": "podemos",
            "Uds.": "pueden",
            "ellos": "pueden"
        }
    },
    {
        "verbo": "servir",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "sirvo",
            "t√∫": "sirves",
            "√©l": "sirve",
            "ella": "sirve",
            "Ud.": "sirve",
            "nosotros": "servimos",
            "Uds.": "sirven",
            "ellos": "sirven"
        }
    },
    {
        "verbo": "decir",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "digo",
            "t√∫": "dices",
            "√©l": "dice",
            "ella": "dice",
            "Ud.": "dice",
            "nosotros": "decimos",
            "Uds.": "dicen",
            "ellos": "dicen"
        }  
    },
    {
        "verbo": "venir",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "vengo",
            "t√∫": "vienes",
            "√©l": "viene",
            "ella": "viene",
            "Ud.": "viene",
            "nosotros": "venimos",
            "Uds.": "vienen",
            "ellos": "vienen"
        }
        
    },
    {
        "verbo": "tener",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "tengo",
            "t√∫": "tienes",
            "√©l": "tiene",
            "ella": "tiene",
            "Ud.": "tiene",
            "nosotros": "tenemos",
            "Uds.": "tienen",
            "ellos": "tienen"
        }
    },
]
}

var conjPreterito = {
    "exercice": [
    {
        "verbo": "hablar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "hable",
            "t√∫": "hablaste",
            "√©l": "hablo",
            "ella": "hablo",
            "Ud.": "hablo",
            "nosotros": "hablamos",
            "Uds.": "hablaron",
            "ellos": "hablaron"
        }
    },
    {
        "verbo": "comer",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "comi",
            "t√∫": "comiste",
            "√©l": "comio",
            "ella": "comio",
            "Ud.": "comio",
            "nosotros": "comimos",
            "Uds.": "comieron",
            "ellos": "comieron"
        }
    },
    {
        "verbo": "practicar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "practique",
            "t√∫": "practicaste",
            "√©l": "practico",
            "ella": "practico",
            "Ud.": "practico",
            "nosotros": "practicamos",
            "Uds.": "practicaron",
            "ellos": "practicaron"
        }
    },
    {
        "verbo": "jugar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "jugue",
            "t√∫": "jugaste",
            "√©l": "jugo",
            "ella": "jugo",
            "Ud.": "jugo",
            "nosotros": "jugamos",
            "Uds.": "jugaron",
            "ellos": "jugaron"
        }  
    },
    {
        "verbo": "empezar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "empece",
            "t√∫": "empezaste",
            "√©l": "empezo",
            "ella": "empezo",
            "Ud.": "empezo",
            "nosotros": "empezamos",
            "Uds.": "empezaron",
            "ellos": "empezaron"
        }
        
    },
    {
        "verbo": "cruzar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "cruce",
            "t√∫": "cruzaste",
            "√©l": "cruzo",
            "ella": "cruzo",
            "Ud.": "cruzo",
            "nosotros": "cruzamos",
            "Uds.": "cruzaron",
            "ellos": "cruzaron"
        }
    },
    {
        "verbo": "tocar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "toque",
            "t√∫": "tocaste",
            "√©l": "toco",
            "ella": "toco",
            "Ud.": "toco",
            "nosotros": "tocamos",
            "Uds.": "tocaron",
            "ellos": "tocaron"
        }
    },
    {
        "verbo": "pagar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "pague",
            "t√∫": "pagaste",
            "√©l": "pago",
            "ella": "pago",
            "Ud.": "pago",
            "nosotros": "pagamos",
            "Uds.": "pagaron",
            "ellos": "pagaron"
        }
    },
    {
        "verbo": "buscar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "busque",
            "t√∫": "buscaste",
            "√©l": "busco",
            "ella": "busco",
            "Ud.": "busco",
            "nosotros": "buscamos",
            "Uds.": "buscaron",
            "ellos": "buscaron"
        }
    },
    {
        "verbo": "llegar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "llegue",
            "t√∫": "llegaste",
            "√©l": "llego",
            "ella": "llego",
            "Ud.": "llego",
            "nosotros": "llegamos",
            "Uds.": "llegaron",
            "ellos": "llegaron"
        }
    },
    {
        "verbo": "salir",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "sali",
            "t√∫": "saliste",
            "√©l": "salio",
            "ella": "salio",
            "Ud.": "salio",
            "nosotros": "salimos",
            "Uds.": "salieron",
            "ellos": "salieron"
        }
    },
    {
        "verbo": "aprender",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "aprendi",
            "t√∫": "aprendiste",
            "√©l": "aprendio",
            "ella": "aprendio",
            "Ud.": "aprendio",
            "nosotros": "aprendimos",
            "Uds.": "aprendieron",
            "ellos": "aprendieron"
        }
    },
]
}

var conjPreteritoIrregular = {
    "exercice": [
    {
        "verbo": "ser",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "fui",
            "t√∫": "fuiste",
            "√©l": "fue",
            "ella": "fue",
            "Ud.": "fue",
            "nosotros": "fuimos",
            "Uds.": "fueron",
            "ellos": "fueron"
        }
    },
    {
        "verbo": "ir",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "fui",
            "t√∫": "fuiste",
            "√©l": "fue",
            "ella": "fue",
            "Ud.": "fue",
            "nosotros": "fuimos",
            "Uds.": "fueron",
            "ellos": "fueron"
        }
    },
    {
        "verbo": "tener",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "tuve",
            "t√∫": "tuviste",
            "√©l": "tuvo",
            "ella": "tuvo",
            "Ud.": "tuvo",
            "nosotros": "tuvimos",
            "Uds.": "tuvieron",
            "ellos": "tuvieron"
        }
    },
    {
        "verbo": "estar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "estuve",
            "t√∫": "estuviste",
            "√©l": "estuvo",
            "ella": "estuvo",
            "Ud.": "estuvo",
            "nosotros": "estuvimos",
            "Uds.": "estuvieron",
            "ellos": "estuvieron"
        }  
    },
    {
        "verbo": "hacer",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "hice",
            "t√∫": "hiciste",
            "√©l": "hizo",
            "ella": "hizo",
            "Ud.": "hizo",
            "nosotros": "hicimos",
            "Uds.": "hicieron",
            "ellos": "hicieron"
        }
        
    },
    {
        "verbo": "querer",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "quise",
            "t√∫": "quisiste",
            "√©l": "quiso",
            "ella": "quiso",
            "Ud.": "quiso",
            "nosotros": "quisimos",
            "Uds.": "quisieron",
            "ellos": "quisieron"
        }
    },
    {
        "verbo": "venir",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "vine",
            "t√∫": "viniste",
            "√©l": "vino",
            "ella": "vino",
            "Ud.": "vino",
            "nosotros": "vinimos",
            "Uds.": "vinieron",
            "ellos": "vinieron"
        }
    },
    {
        "verbo": "poder",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "pude",
            "t√∫": "pudiste",
            "√©l": "pudo",
            "ella": "pudo",
            "Ud.": "pudo",
            "nosotros": "pudimos",
            "Uds.": "pudieron",
            "ellos": "pudieron"
        }
    }
]
}

var imperfecto = {
    "exercice": [
    {
        "verbo": "jugar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "jugaba",
            "t√∫": "jugabas",
            "√©l": "jugaba",
            "ella": "jugaba",
            "Ud.": "jugaba",
            "nosotros": "jugabamos",
            "Uds.": "jugaban",
            "ellos": "jugaban"
        }
    },
    {
        "verbo": "ir",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "iba",
            "t√∫": "ibas",
            "√©l": "iba",
            "ella": "iba",
            "Ud.": "iba",
            "nosotros": "ibamos",
            "Uds.": "iban",
            "ellos": "iban"
        }
    },
    {
        "verbo": "tener",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "tenia",
            "t√∫": "tenias",
            "√©l": "tenia",
            "ella": "tenia",
            "Ud.": "tenia",
            "nosotros": "teniamos",
            "Uds.": "tenian",
            "ellos": "tenian"
        }
    },
    {
        "verbo": "estar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "estaba",
            "t√∫": "estabas",
            "√©l": "estaba",
            "ella": "estaba",
            "Ud.": "estaba",
            "nosotros": "estabamos",
            "Uds.": "estaban",
            "ellos": "estaban"
        }  
    },
    {
        "verbo": "hacer",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "hacia",
            "t√∫": "hacias",
            "√©l": "hacia",
            "ella": "hacia",
            "Ud.": "hacia",
            "nosotros": "haciamos",
            "Uds.": "hacian",
            "ellos": "hacian"
        }
        
    },
    {
        "verbo": "querer",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "queria",
            "t√∫": "querias",
            "√©l": "queria",
            "ella": "queria",
            "Ud.": "queria",
            "nosotros": "queriamos",
            "Uds.": "querian",
            "ellos": "querian"
        }
    },
    {
        "verbo": "ser",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "era",
            "t√∫": "eras",
            "√©l": "era",
            "ella": "era",
            "Ud.": "era",
            "nosotros": "eramos",
            "Uds.": "eran",
            "ellos": "eran"
        }
    },
    {
        "verbo": "ver",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "yo": "veia",
            "t√∫": "veias",
            "√©l": "veia",
            "ella": "veia",
            "Ud.": "veia",
            "nosotros": "veiamos",
            "Uds.": "veian",
            "ellos": "veian"
        }
    }
]
}


var imperativo = {
    "exercise_title": "Conjugaci√≥n en imperativo",
    "intro": "An imperative is a verb form used to give commands, requests, or instructions, typically expressed in the base form without specifying the subject.",
    "instruction": "Conjuga el verbo",
    "exercice": [
     {
        "verbo": "hablar",
        "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "(t√∫)": "habla",
            "(Ud.)": "hable",
            "(nosotros)": "hablemos",
            "(Uds.)": "hablen",
        }
    },
    {
        "verbo": "comer",
        "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "(t√∫)": "come",
            "(Ud.)": "coma",
            "(nosotros)": "comamos",
            "(Uds.)": "coman",
        }
    },
    {
        "verbo": "escuchar",
        "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "(t√∫)": "escucha",
            "(Ud.)": "escuche",
            "(nosotros)": "escuchemos",
            "(Uds.)": "escuchen",
        }
    },
    {
        "verbo": "hablar (negativo)",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "(t√∫)": "no hables",
            "(Ud.)": "no hable",
            "(nosotros)": "no hablemos",
            "(Uds.)": "no hablen",
        }
    },
    {
        "verbo": "llamar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "(t√∫)": "llama",
            "(Ud.)": "llame",
            "(nosotros)": "llamemos",
            "(Uds.)": "llamen",
        }
    },
    {
        "verbo": "llamar (negativo)",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "(t√∫)": "no llames",
            "(Ud.)": "no llame",
            "(nosotros)": "no llamemos",
            "(Uds.)": "no llamen",
        }
    },
    {
        "verbo": "limpiar (negativo)",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "(t√∫)": "no limpies",
            "(Ud.)": "no limpie",
            "(nosotros)": "no limpiemos",
            "(Uds.)": "no limpien",
        }
    },
    {
        "verbo": "limpiar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "(t√∫)": "limpia",
            "(Ud.)": "limpie",
            "(nosotros)": "limpiemos",
            "(Uds.)": "limpien",
        }
    },
    {
        "verbo": "reciclar",
                "complement": "",
        "hint_complement": "",
        "hint_verb": "",
        "subject": {
            "(t√∫)": "recicla",
            "(Ud.)": "recicle",
            "(nosotros)": "reciclemos",
            "(Uds.)": "reciclen",
        }
    }
]
   
}
 


var expresionesImperativo = {
    "exercise_title": "Expresiones en imperativo",
    "intro": "An imperative is a verb form used to give commands, requests, or instructions, typically expressed in the base form without specifying the subject.",
    "instruction": "Translate the English phrase into Spanish. If you need help, click on the verb or complement. Each click will cost you virtual coins. You'll earn more coins by completing exercises without hints.",
    "exercice": [
    {
        "verbo": "don't be",
        "complement": "rude!",
        "hint_complement": "grosero(s)",
        "hint_verb": "no seas/sea/sean",
        "subject": {
            "(t√∫)": "¬°no seas grosero!",
            "(Ud.)": "¬°no sea grosero!",
            "(Uds.)": "¬°no sean groseros!",
        }
    },
    {
        "verbo": "be",
        "complement": "nice to your friends!",
        "hint_complement": "amable(s) con tus/sus amigos",
        "hint_verb": "se/sea/sean",
        "subject": {
            "(t√∫)": "¬°s√© amable con tus amigos!",
            "(Ud.)": "¬°sea amable con sus amigos!",
            "(Uds.)": "¬°sean amables con sus amigos!",
        }
    },
    {
        "verbo": "get out",
        "complement": "of here!",
        "hint_complement": "de aqu√≠",
        "hint_verb": "sal/salga/salgan",
        "subject": {
            "(t√∫)": "¬°sal de aqu√≠!",
            "(Ud.)": "¬°salga de aqu√≠!",
            "(Uds.)": "¬°salgan de aqu√≠!",
        }
    },
    {
        "verbo": "be",
        "complement": "patient!",
        "hint_complement": "paciente(s)",
        "hint_verb":  "se/sea/sean",
        "subject": {
            "(t√∫)": "¬°s√© paciente!",
            "(Ud.)": "¬°sea paciente!",
            "(Uds.)": "¬°sean pacientes!",
        }
    },
    {
        "verbo": "get out!",
        "complement": "",
        "hint_complement": "",
        "hint_verb":  "sal/salga/salgan",
        "subject": {
            "(t√∫)": "¬°sal!",
            "(Ud.)": "¬°salga!",
            "(Uds.)": "¬°salgan!",
        }
    },
    {
        "verbo": "shut",
        "complement": "the door!",
        "hint_complement": "la puerta",
        "hint_verb":  "cierra/cierre/cierren",
        "subject": {
            "(t√∫)": "¬°cierra la puerta!",
            "(Ud.)": "¬°cierre la puerta!",
            "(Uds.)": "¬°cierren la puerta!",
        }
    },
    {
        "verbo": "don't close",
        "complement": "the door!",
        "hint_complement": "la puerta",
        "hint_verb":  "no cierres/cierre/cierren",
        "subject": {
            "(t√∫)": "¬°no cierres la puerta!",
            "(Ud.)": "¬°no cierre la puerta!",
            "(Uds.)": "¬°no cierren la puerta!",
        }
    },
    {
        "verbo": "drive",
        "complement": "carefully!",
        "hint_complement": "con cuidado",
        "hint_verb":  "conduce/conduzca/conduzcan",
        "subject": {
            "(t√∫)": "¬°conduce con cuidado!",
            "(Ud.)": "¬°conduzca con cuidado!",
            "(Uds.)": "¬°conduzcan con cuidado!",
        }
    },
    {
        "verbo": "be",
        "complement": "careful!",
        "hint_complement": "cuidado",
        "hint_verb":  "ten/tenga/tengan",
        "subject": {
            "(t√∫)": "¬°ten cuidado!",
            "(Ud.)": "¬°tenga cuidado!",
            "(Uds.)": "¬°tengan cuidado!",
        }
    },
    {
        "verbo": "do",
        "complement": "your homework!",
        "hint_complement": "tu/su tarea",
        "hint_verb":  "haz/haga/hagan",
        "subject": {
            "(t√∫)": "¬°haz tu tarea!",
            "(Ud.)": "¬°haga su tarea!",
        }
    },
    {
        "verbo": "clean",
        "complement": "your room!",
        "hint_complement": "tu/su habitaci√≥n",
        "hint_verb":  "limpia/limpie/limpien",
        "subject": {
            "(t√∫)": "¬°limpia tu habitaci√≥n!",
            "(Ud.)": "¬°limpie su habitaci√≥n!",
        }
    },
    {
        "verbo": "don't touch",
        "complement": "the hot stove!",
        "hint_complement": "la estufa caliente",
        "hint_verb":  "no toques/toque/toquen",
        "subject": {
            "(t√∫)": "¬°no toques la estufa caliente!",
            "(Ud.)": "¬°no toque la estufa caliente!",
            "(Uds.)": "¬°no toquen la estufa caliente!",
        }
    },
    {
        "verbo": "eat",
        "complement": "your vegetables!",
        "hint_complement": "tus/sus vegetales",
        "hint_verb":  "come/coma/coman",
        "subject": {
            "(t√∫)": "¬°come tus vegetales!",
            "(Ud.)": "¬°coma sus vegetales!",
            "(Uds.)": "¬°coman sus vegetales!",
        }
    },
    {
        "verbo": "pass",
        "complement": "the salt!",
        "hint_complement": "la sal",
        "hint_verb":  "pasa/pase/pasen",
        "subject": {
            "(t√∫)": "¬°pasa la sal!",
            "(Ud.)": "¬°pase la sal!",
            "(Uds.)": "¬°pasen la sal!",
        }
    },
    {
        "verbo": "let's grab",
        "complement": "a coffee!",
        "hint_complement": "un caf√©",
        "hint_verb":  "tomar",
        "subject": {
            "(nosotros)": "¬°tomemos un caf√©!",

        }
    },
    {
        "verbo": "let's talk!",
        "complement": "",
        "hint_complement": "",
        "hint_verb":  "hablar",
        "subject": {
            "(nosotros)": "¬°hablemos!",

        }
    },
    {
        "verbo": "let's make",
        "complement": "a plan!",
        "hint_complement": "un plan",
        "hint_verb":  "hacer",
        "subject": {
            "(nosotros)": "¬°hagamos un plan!",

        }
    },
    {
        "verbo": "let's go",
        "complement": "to the beach!",
        "hint_complement": "a la playa",
        "hint_verb":  "ir",
        "subject": {
            "(nosotros)": "¬°vamos a la playa!",

        }
    },
]

}





 



    function getRandomInt(max) {
        return Math.floor(Math.random() * max);
    }


    var pickedVerb;
    var pickedSubject;
    var exercise_title;
    var exercise_instruction;

    // pickedVerb = conj[getRandomInt(conj.length)]
    //         pickedSubject = pickedVerb.subject
    if (tense==="presente_irregular") {
        exercise_title = irrePresent.exercise_title
        exercise_instruction = irrePresent.instruction
        pickedVerb = irrePresent.exercice[getRandomInt(irrePresent.exercice.length)]
        pickedSubject = pickedVerb.subject
        console.log("in if statement tense_ " + tense + "pickedVerb " + pickedVerb.verbo)

    }
    if (tense==="preterito") {
        exercise_title = conjPreterito.exercise_title
        exercise_instruction = conjPreterito.instruction
        pickedVerb = conjPreterito.exercice[getRandomInt(conjPreterito.exercice.length)]
        pickedSubject = pickedVerb.subject
        console.log("in if statement tense_ " + tense + "pickedVerb " + pickedVerb.verbo)

    }
    if (tense==="preterito_irregular") {
        exercise_title = conjPreteritoIrregular.exercise_title
        exercise_instruction = conjPreteritoIrregular.instruction
        pickedVerb = conjPreteritoIrregular.exercice[getRandomInt(conjPreteritoIrregular.exercice.length)]
        pickedSubject = pickedVerb.subject
        console.log("in if statement tense_ " + tense + "pickedVerb " + pickedVerb.verbo)

    }
    if (tense==="presente") {
        exercise_title = conj.exercise_title
        exercise_instruction = conj.instruction
        pickedVerb = conj.exercice[getRandomInt(conj.exercice.length)]
        pickedSubject = pickedVerb.subject
        console.log("in if statement tense_ " + tense + "pickedVerb " + pickedVerb.verbo)

    }
    if (tense==="imperfecto") {
        exercise_title = imperfecto.exercise_title
        exercise_instruction = imperfecto.instruction
        pickedVerb = imperfecto.exercice[getRandomInt(imperfecto.exercice.length)]
        pickedSubject = pickedVerb.subject
        console.log("in if statement tense_ " + tense + "pickedVerb " + pickedVerb.verbo)

    }
    if (tense==="imperativo") {
        exercise_title = imperativo.exercise_title
        exercise_instruction = imperativo.instruction
        pickedVerb = imperativo.exercice[getRandomInt(imperativo.exercice.length)]
        pickedSubject = pickedVerb.subject
        console.log("in if statement tense_ " + tense + "pickedVerb " + pickedVerb.verbo)

    }
    if (tense==="expresionesImperativo") {
        exercise_title = expresionesImperativo.exercise_title
        exercise_instruction = expresionesImperativo.instruction
        pickedVerb = expresionesImperativo.exercice[getRandomInt(expresionesImperativo.exercice.length)]
        pickedSubject = pickedVerb.subject
        console.log("in if statement tense_ " + tense + "pickedVerb " + pickedVerb.verbo)

    }
    console.log("out of if statement tense_ " + tense + "pickedVerb " + pickedVerb.verbo)
    console.log("el tiempo es " + tense)


   

    document.getElementById("exercise_title").innerHTML = exercise_title
    document.getElementById("instruction").innerHTML = exercise_instruction


    verbo.innerHTML = pickedVerb.verbo;
    complement.innerHTML = "&nbsp;" + pickedVerb.complement;
    var subject = Object.keys(pickedSubject);
    let count= Object.keys(pickedSubject).length; 


    var pronounPicked = subject[getRandomInt(count)];

    console.log("count is: " + count)

    console.log("pronounPicked: " + pronounPicked);
    console.log("pickedSubject[pronounPicked] " + pickedSubject[pronounPicked]);

    subjectToShow.innerHTML = pronounPicked;


    complementHint = pickedVerb.hint_complement
    verbHint = pickedVerb.hint_verb
    correctAnswer = pickedSubject[pronounPicked]


    // This flag prevent user to being deducted points when his/her question is wrong and keep tyring
    var flag = false;
    var isCorrect = true;
    var reavealAnswerAttempts = 2;

    function handleIncorrectAnswer() {
        // console.log("error statement was excecuted...")
        // // cosole.log("if (verboConjugado !== pickedSubject[pronounPicked] && pickedSubject[pronounPicked] !== null && flag === false) " + verboConjugado + " " + pickedSubject[pronounPicked] + " " + pickedSubject[pronounPicked] + " " + flag)
        // console.log("inside else pickedSubject[pronounPicked] = " + pickedSubject[pronounPicked] )
        
        
        if (isCorrect) {
            
            verbosMistakes[correctAnswer] = "err"
            lifesavers--
            if (lifesavers === 2) {
                document.getElementById("lifesavers1").setAttribute("id", "drop");
            }
            if (lifesavers === 1) {
                document.getElementById("lifesavers2").setAttribute("id", "drop");
            }
            if (lifesavers === 0) {
                document.getElementById("lifesavers3").setAttribute("id", "drop");
            }
            flag = true;
            
            if (lifesavers < 0) {
                negScore++
                incorrect.innerHTML = negScore;
                
                progress = progress -4
            }
            
            
        }
        isCorrect = false;
        reavealAnswerAttempts--
        
        
        document.getElementById("fb").innerHTML = "incorrect"
        if (reavealAnswerAttempts <= 0){
            document.getElementById("correctAnswer").innerHTML = correctAnswer;
        }
        
    }













    function updateProgress() {
        fina100score = progress;

        // Your custom function or code here
        document.getElementById("ratio").innerHTML = ((score / (score + negScore)) * 100).toFixed(2)
        document.getElementById("progress-ui").innerHTML = progress
        if (progress <= 110) {
        // calculate grade
        grade = (((score / (score + negScore)) * 100) * progress/100).toFixed(2)

            document.getElementById("grade").innerHTML = grade;
        }
    }







    const regex = /¬°|!/g;
   
    


    document.addEventListener('keydown', function(event) {
    // Check if the pressed key is the one you are interested in

    var continueSkip = false;

    
    
    
    
    if (event.key === 'Enter') {
        verboConjugado = document.getElementById("verboConjugado").value;
        
        var userInput = verboConjugado.toLowerCase().trim().replaceAll(regex, '').replaceAll("√°", "a").replaceAll("√©", "e").replaceAll("√≠", "i").replaceAll("√≥", "o").replaceAll("√∫", "u");
        var rightAnswer = pickedSubject[pronounPicked].trim().replaceAll(regex, '').replaceAll("√°", "a").replaceAll("√©", "e").replaceAll("√≠", "i").replaceAll("√≥", "o").replaceAll("√∫", "u");

        // console.log(verboConjugado +  "=" + pickedSubject[pronounPicked])



        if ( userInput === rightAnswer){
            document.getElementById("fb").innerHTML = "Correct"

            if (isCorrect || reavealAnswerAttempts >= 1) {
                score++
                points.innerHTML = score;
                progress = progress + 2
                audioFB.load();
                audioFB.play();

                if (hintUsed === false) {
                hintNum++
                document.getElementById("coinsForHint").innerHTML = hintNum
            }
            }
            isCorrect = false;

            reavealAnswerAttempts = 2;



            pickedSubject[pronounPicked] = null
            rightAnswer = null
            console.log("before load" + verboConjugado +  "=" + pickedSubject[pronounPicked])
            console.log("this line was excecuteed")

            document.getElementById("verboConjugado").value = "";
    
            

        
            onload()
            updateProgress();

            console.log("last line of if correct pickedSubject[pronounPicked] = " + pickedSubject[pronounPicked] )
        }
          
        // if (isSkipped){
        //     handleIncorrectAnswer()
        //     onload()
        //     isSkipped = false;
        // }
        if (userInput !== rightAnswer && rightAnswer !== null){
        // if (userInput !== rightAnswer){
            audioNegFB.load();
            audioNegFB.play();
            // alert("userInput: " + userInput)
            // alert("rightAnswer: " + rightAnswer)
        }
        if (userInput !== rightAnswer && rightAnswer !== null){
        // if (userInput !== rightAnswer && rightAnswer !== null && flag === false){
        // if (userInput !== rightAnswer && flag === false){
            handleIncorrectAnswer()
            updateProgress();
        }


    




      console.log('Enter key pressed!');
    }
  });


   
          


    
    // function myFunction(){
    //     var verboConjugado = document.getElementById("verboConjugado").value;


    //     if (verboConjugado === "juego")
    //         alert("yes!");
    //     else document.getElementById("fb").innerHTML = "wrong"

    //         // alert(verboConjugado);
    // }






    }

    

</script>
</html>
